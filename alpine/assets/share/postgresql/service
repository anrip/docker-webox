#!/bin/sh
#

export PGHOME=/var/lib/postgresql

export PGDATA=$PGHOME/data
export PGUSER=postgres

############################################################

app_start() {

    su-exec $PGUSER pg_ctl -w start

    if [ -f $PGHOME/import.sql ]; then
        su-exec $PGUSER psql < $PGHOME/import.sql
        mv $PGHOME/import.sql $PGHOME/import.done
    fi

}

app_stop() {

    su-exec $PGUSER pg_ctl -w stop

}

app_reload() {

    su-exec $PGUSER pg_ctl -w reload

}

app_restart() {

    su-exec $PGUSER pg_ctl -w restart

}

############################################################

echo "${1} postgresql ..."
app_${@}

if [ ${?} -ne 0 ]; then
    echo "${1} postgresql failed"
fi
